<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Documentation for Gibbs sampling process • geneference</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">
<!-- preferably CSS --><link rel="stylesheet" href="../preferably.css">
<link id="css-code-light" rel="stylesheet" href="../code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="../code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">
<!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Documentation for Gibbs sampling process">
<meta property="og:description" content="This vignette provides some details on the Gibbs sampler we use as part of computing the LT-FH phenotype.
">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geneference</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/geneference.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/FireGutter/geneference/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
        
        


      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gibbs_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Documentation for Gibbs sampling process</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/FireGutter/geneference/blob/master/vignettes/gibbs.Rmd"><code>vignettes/gibbs.Rmd</code></a></small>
      <div class="hidden name"><code>gibbs.Rmd</code></div>

    </div>

    
    
<p>The refined phenotype introduced by Hujoel et al. (2020) relies on the assumption that liabilities follow a multivariate normal distribution. <em>A more detailed explanation of these assumptions can be found in</em> <code><a href="../articles/liability-distribution.html">vignette("liability-distribution")</a></code>.<br>
The proposed phenotype consists of estimating the genetic liability of a family configuration. This is called the <em>posterior mean genetic liability</em>. In this vignette, we explain how we sample genetic liabilities and compute posterior mean genetic liabilities.</p>
<div id="gibbs-sampling" class="section level2">
<h2 class="hasAnchor">
<a href="#gibbs-sampling" class="anchor"></a>Gibbs sampling</h2>
<p>An efficient way of obtaining genetic liabilities that conform to a certain conditional distribution (i.e. fits a certain configuration), is through Gibbs sampling. We can use Gibbs sampling since we can calculate the marginal distribution of each liability conditional on the other liabilities. To further optimise this process, we transform the full liabilities to make sure that the area we sample from fits the configuration.<br>
The procedure is outlined in the below pseudocode. Here, <span class="math inline">\(T\)</span> denotes the threshold used in the liabiity threshold model for assignment of phenotype status, <span class="math inline">\(\epsilon\)</span> are liabilities and <span class="math inline">\(z_j\)</span> is the phenotype status of the individual having full liability <span class="math inline">\(\epsilon_j\)</span>. Finally, we note that in the implementation in <strong>geneference</strong>, the for-loop starting at line 2 instead goes to the chosen number of burn-in iterations, which we talk more about in the concluding part of this vignette. Furthermore, the algorithm is nested inside a while-loop, which breaks when the standard error of mean genetic liability is below 0.01.<br><img src="../man/figures/gibbs-pseudo.png"></p>
<p>Intuitively, the effect of the transformation can be thought of as forcing the samples to live in the area we expect from the configuration. So, instead of steadily moving closer to convergence, we immediately jump to the relevant area. We therefore expect very quick convergence of the sampler.</p>
</div>
<div id="plotting-convergence" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-convergence" class="anchor"></a>Plotting convergence</h2>
<p>One very important aspect of using Gibbs sampling is to ensure convergence of the sampler. We chose to do this through visualisation, i.e. plotting the values generated by the Gibbs sampler and seeing how many iterations are needed before the values seem stable. In this vignette, we showcase some of the plots we used when implementing our Gibbs sampler.</p>
<p>The code used for generating the data in this vignette is slightly different from the sampler implemented in our package. The general idea is the same, but it differs in that we save all values generated, whereas we in <strong>geneference</strong> only save genetic liabilities after burn-in. This is less efficient, but enables us to plot the convergence.</p>
<p>Below, we show a few of the plots we used in our implementation process for deciding on a fitting number of iterations in the burn-in of the sampler, as well as a starting value for the liabilities.</p>
<p>In these examples, we deal with a setup of 2 parents and no siblings. In our specification of case-control status, 1 means control and 2 means case. So, for instance, the configuration string “222” means that both the individual, parent number 1 and parent number 2 are all cases, while “111” means that everyone are controls.<br>
For each of the chosen configurations, we draw 1000 samples with different starting values, then we plot how the liabilities develop over time to see when they are no longer dependent on the starting value.</p>
<p><img src="gibbs_files/figure-html/plots-1.png" width="100%"><img src="gibbs_files/figure-html/plots-2.png" width="100%"><img src="gibbs_files/figure-html/plots-3.png" width="100%"><img src="gibbs_files/figure-html/plots-4.png" width="100%"></p>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p>The plots show that all liabilities are independent of their starting value after just a couple of samples, and that it does not matter which starting value is used. This is the case for both of the shown configurations. Therefore, we can conclude that there is no difference in the burn-in iterations for different starting values and that the burn-in is done after just a couple of iterations.<br>
In other words, the Gibbs sampler performs as expected.</p>
<p>The current implementation of the Gibbs sampler uses 3 as its starting value for each liability.<br>
To make sure that all liabilities are independent of the starting value for any given configuration, we have set the number of iterations for the burn-in to be 200. This should be enough iterations to ensure any configuration has valid liabilities to sample from.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by FireGutter, Jacob Birkeland Steenstrup, Rasmus Brostrøm Jensen, Magnus Conradsen, Marc Timmer Jensen.</p>
</div>

<div class="pkgdown">
  <p>Made with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1, using <a href="https://preferably.amirmasoudabdol.name/?source=footer">preferably</a> template.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
