---
title: "Expected running times and sizes of simulations"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Expected running times and sizes of simulations}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This vignette lists a few runs of different simulation functions to give an idea of what running times are to be expected and how much disk space is required for different sizes of simulations.

I suggest that we make a table, either with markdown formatting or some use of tibbles and kable.

```{r, message=FALSE, warning=FALSE, echo=FALSE}
library(tidyverse)
library(knitr)
library(kableExtra)
```


```{r, echo=FALSE}
run_times <- tibble(id = c(1, 2, 3, 4, 5, 6, 7),
               n = format(c(1e5, 1e5, 1e5, 1e5, 1e5, 1e5, 1e5), digits=7),
               m = format(c(1e5, 1e5, 1e5, 1e5, 1e5, 1e5, 1e5), digits=7), 
               q = c(1000, 500, 10, 1000, 5000, 500, 25),
               hsq = c(0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5),
               k = c(0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05),
               sib = c(2, 2, 4, 0, 3, 4, 2),
               Run_time = c(2974.25, 2936.11, 3355.88, 4540.06, 9551.67, 11207.75, 11581.89),
               cores = c(7, 7, 7, 3, 3, 3, 3)
               )
```



```{r, echo=FALSE}
run_times %>% 
kable(caption =  '<b>Run times</b>',
      format = "html",
      align = "c") %>% 
  kable_styling(full_width = T)
```

Bear in mind that these run times doesn't take into account, the amount of memory available, the frequency of the memory, the frequency of the CPU or the write speed of the disk. Write speed probably being the most important of these factors, because the most time consuming element in the simulation is the writing of data to the disk. The simulations done by the 7 core system is better in all the prior mentioned factors the 3 core system.

```{r, echo=FALSE}
file_sizes <- tibble("n"= c(1e5, 1e4, 1e4, 1e5, 5e4),
                     "m"= c(1e5, 1e4, 1e5, 1e4, 5e4),
                     ".ped and .map total file size (GB)" = c(39.62, 0.37, 3.73, 3.73, 9.31),
                     ".bed, .bim and .fam total file size (GB)" = c(2.33, 0.02, 0.23, 0.23, 0.58))
                     
```


```{r, echo=FALSE}
bedsamlet <- 2077784 + 1688894 + 2500000003
pedsamlet <- 42540100367 + 1677788
ped2 <- 400158894 + 147788
bed3 <- 250000003 + 187788 + 1688894
ped3 <- 4000158894 + 1677788
bed4 <- 250000003 + 187788 + 1688894
ped4 <- 4001688894 + 147788
bed5 <- 625000003 + 1027788 + 838894
ped5 <- 10000838894 + 827788
bed2 <- 25000003 + 187788 + 158894
```


```{r, echo=FALSE}
file_sizes %>% 
kable(caption =  '<b>File sizes</b>',
      format = "html",
      align = "c") %>% 
  kable_styling(full_width = T)
```

The size of the .ped and .map files pretty much follow the linear function $file\_size \approx n \cdot m \cdot 3.7 \cdot 10^{-9}$ the same goes for .bed, .bim and .fam with the function $file\_size \approx n \cdot m \cdot 2.3 \cdot 10^{-10}$.
From the table we also see that it is favorable to store the data in .bed/.bim/.fam format, since it only uses a $\frac{1}{17}$ of the space .ped/.map uses.
